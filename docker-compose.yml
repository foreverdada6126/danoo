services:
  # 1. DANOO CORE (The Brain & Wallet)
  danoo-core:
    build: 
      context: .
      dockerfile: Dockerfile
    container_name: danoo-core
    ports:
      - "8000:8000"
    env_file: .env
    volumes:
      - ./data:/app/data
      - ./database:/app/database
      - ./logs:/app/logs
    restart: always
    networks:
      - danoo-net

  # 2. INTEL SERVICE (The Researcher - LangChain)
  intel-service:
    build:
      context: .
      dockerfile: Dockerfile.intel
    container_name: intel-service
    ports:
      - "5000:5000"
    env_file: .env
    restart: always
    networks:
      - danoo-net

  # 3. OPENCLAW (The Voice & Interface)
  # Building from a clean python image to avoid registry pull errors
  openclaw-agent:
    image: python:3.11-slim
    container_name: openclaw-agent
    working_dir: /app
    volumes:
      - .:/app
    command: >
      bash -c "pip install --no-cache-dir -r requirements.txt && python app.py"
    env_file: .env
    ports:
      - "3456:3456"
    restart: always
    networks:
      - danoo-net

networks:
  danoo-net:
    driver: bridge