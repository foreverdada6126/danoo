<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DaNoo | Institutional Command Hub</title>
    <!-- Modern Typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@500;700&family=Space+Mono&display=swap"
        rel="stylesheet">
    <!-- Tailwind CSS Play CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            bg: '#050608',
                            card: 'rgba(17, 21, 28, 0.7)',
                            border: 'rgba(255, 255, 255, 0.08)',
                            cyan: '#00f2ff',
                            green: '#22ab94',
                            red: '#f23645',
                            text: '#d1d4dc',
                            dim: '#787b86'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Space Grotesk', 'sans-serif'],
                        mono: ['Space Mono', 'monospace'],
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="/static/style.css">
</head>

<body>
    <div class="min-h-screen bg-brand-bg text-brand-text font-sans antialiased overflow-hidden flex flex-col">
        <!-- Main Header -->
        <header
            class="h-14 flex items-center justify-between px-6 bg-brand-card/30 backdrop-blur-xl border-b border-brand-border sticky top-0 z-50">
            <div class="flex items-center gap-4">
                <div
                    class="w-8 h-8 rounded-lg bg-brand-cyan shadow-[0_0_20px_rgba(0,242,255,0.4)] flex items-center justify-center font-display font-bold text-black text-xl">
                    D</div>
                <div class="flex flex-col leading-tight">
                    <h1 class="font-display font-bold text-lg tracking-tight text-white">Da<span
                            class="text-brand-cyan italic">Noo</span></h1>
                    <span class="text-[9px] font-mono text-brand-dim uppercase tracking-widest">v5.2.5
                        [Institutional]</span>
                </div>
            </div>

            <div class="hidden xl:flex items-center gap-8">
                <div class="flex flex-col items-center">
                    <span class="text-[9px] text-brand-dim uppercase tracking-widest mb-0.5">Account Equity</span>
                    <span id="equity-value"
                        class="font-display font-bold text-brand-cyan text-sm tracking-tight">$0.00</span>
                </div>
                <div class="flex flex-col items-center border-l border-brand-border pl-8">
                    <span class="text-[9px] text-brand-dim uppercase tracking-widest mb-0.5">Market Regime</span>
                    <span id="regime-value"
                        class="font-display font-bold text-white text-sm tracking-tight uppercase">Scanning</span>
                </div>
                <div class="flex flex-col items-center border-l border-brand-border pl-8">
                    <span class="text-[9px] text-brand-dim uppercase tracking-widest mb-0.5">AI Sentiment</span>
                    <span id="sentiment-value"
                        class="font-display font-bold text-brand-cyan text-sm tracking-tight">0.00</span>
                </div>
                <div class="flex flex-col items-center border-l border-brand-border pl-8">
                    <span class="text-[9px] text-brand-dim uppercase tracking-widest mb-0.5">BTC Price</span>
                    <span id="price-value" class="font-display font-bold text-white text-sm tracking-tight">$0.00</span>
                </div>
                <div class="flex flex-col items-center border-l border-brand-border pl-8">
                    <span class="text-[9px] text-brand-dim uppercase tracking-widest mb-0.5">Avg Funding</span>
                    <span id="funding-value"
                        class="font-display font-bold text-brand-dim text-sm tracking-tight">0%</span>
                </div>
            </div>

            <div class="flex items-center gap-3">
                <div id="exchange-status"
                    class="flex items-center gap-2 px-3 py-1.5 rounded-full bg-brand-red/10 border border-brand-red/20 text-brand-red text-[11px] font-bold">
                    <div id="exchange-dot" class="w-1.5 h-1.5 rounded-full bg-brand-red animate-pulse"></div>
                    <span id="exchange-name" class="uppercase tracking-wide">Connecting...</span>
                </div>

                <div class="flex items-center gap-1 bg-white/5 p-1 rounded-lg border border-white/10">
                    <div id="mode-tag" class="px-2 py-1 text-[9px] font-bold text-brand-dim uppercase tracking-tighter">
                        Paper Mode</div>
                </div>

                <button id="ai-toggle-btn"
                    class="px-4 py-1.5 rounded-lg bg-brand-green/10 border border-brand-green/20 text-brand-green text-[11px] font-bold hover:bg-brand-green/20 transition-all uppercase shadow-[0_0_15px_rgba(34,171,148,0.1)]"
                    onclick="toggleAI()">AI: Active</button>
            </div>
        </header>

        <main
            class="flex-1 grid grid-cols-1 lg:grid-cols-[340px_1fr_340px] gap-px bg-brand-border h-[calc(100vh-56px-32px)] overflow-hidden">

            <!-- Left: Trade Desk -->
            <section class="bg-brand-bg flex flex-col h-full overflow-hidden border-r border-brand-border">
                <div
                    class="flex items-center justify-between px-5 py-3.5 bg-brand-card/20 backdrop-blur-md border-b border-brand-border">
                    <h2 class="text-[10px] font-bold tracking-[0.25em] text-brand-dim uppercase">Trade Desk</h2>
                    <div id="trade-tabs-nav" class="flex gap-1 p-0.5 bg-black/40 rounded border border-white/5">
                        <button onclick="setTradeTab('ALL')" data-category="ALL"
                            class="trade-tab active">Trades</button>
                        <button onclick="setTradeTab('OPENED')" data-category="OPENED" class="trade-tab">Opened</button>
                        <button onclick="setTradeTab('CLOSED')" data-category="CLOSED" class="trade-tab">Closed</button>
                    </div>
                </div>
                <div id="trade-list" class="flex-1 overflow-y-auto p-5 custom-scrollbar space-y-3">
                    <div
                        class="flex flex-col items-center justify-center py-10 opacity-30 select-none pointer-events-none">
                        <p class="text-[10px] uppercase tracking-[0.3em] font-bold text-brand-dim text-center">Syncing
                            Trades...</p>
                    </div>
                </div>
            </section>

            <!-- Center: Market Terminal (Now expanded) -->
            <section class="bg-brand-bg flex flex-col h-full overflow-hidden border-r border-brand-border">
                <div class="grid grid-rows-[1.4fr_1fr] h-full gap-px bg-brand-border">
                    <!-- Chart -->
                    <div class="bg-brand-bg flex flex-col overflow-hidden relative">
                        <div class="absolute top-4 left-4 z-10 pointer-events-none">
                            <div
                                class="flex items-center gap-2 px-3 py-1 rounded bg-black/40 backdrop-blur-md border border-white/5">
                                <span class="w-2 h-2 rounded-full bg-red-500 animate-pulse"></span>
                                <span id="market-symbol-title" class="text-[10px] font-mono text-white/80">BTCUSDT
                                    (15M)</span>
                            </div>
                        </div>
                        <div class="flex-1 min-h-0 bg-brand-bg">
                            <div id="tradingview_1" class="h-full w-full opacity-90 grayscale-[0.2] contrast-[1.1]">
                            </div>
                            <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
                            <script type="text/javascript">
                                new TradingView.widget({
                                    "autosize": true,
                                    "symbol": "BYBIT:BTCUSDT",
                                    "interval": "15",
                                    "timezone": "Etc/UTC",
                                    "theme": "dark",
                                    "style": "1",
                                    "locale": "en",
                                    "enable_publishing": false,
                                    "backgroundColor": "rgba(5, 6, 8, 1)",
                                    "gridColor": "rgba(255, 255, 255, 0.03)",
                                    "hide_top_toolbar": true,
                                    "hide_legend": true,
                                    "save_image": false,
                                    "container_id": "tradingview_1"
                                });
                            </script>
                        </div>
                    </div>

                    <!-- Performance -->
                    <div class="bg-brand-bg flex flex-col overflow-hidden">
                        <div
                            class="flex items-center justify-between px-5 py-3 bg-brand-card/10 border-b border-brand-border">
                            <h2 class="text-[10px] font-bold tracking-[0.25em] text-brand-dim uppercase italic">Equity
                                Velocity</h2>
                            <span class="text-[10px] text-brand-cyan/60 font-mono tracking-widest">LIVE DATA FEED</span>
                        </div>
                        <div class="flex-1 p-6">
                            <div class="h-full w-full relative">
                                <canvas id="pnlChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Right: Execution Engine & Intel -->
            <section class="bg-brand-bg flex flex-col h-full overflow-hidden">
                <!-- Recent Intel Slot -->
                <div id="active-intel-panel" class="border-b border-brand-border h-[280px] flex flex-col">
                    <div
                        class="flex items-center justify-between px-5 py-3 bg-brand-card/20 border-b border-brand-border">
                        <h2 class="text-[10px] font-bold tracking-[0.25em] text-brand-dim uppercase">Active Intelligence
                        </h2>
                        <button onclick="window.triggerManualRecon()"
                            class="text-[8px] font-bold text-brand-cyan uppercase hover:underline">Scan</button>
                    </div>
                    <div id="recent-intel-content" class="flex-1 p-5 overflow-y-auto custom-scrollbar">
                        <div
                            class="flex flex-col items-center justify-center h-full opacity-20 pointer-events-none italic text-[10px]">
                            Awaiting Signal Analysis...
                        </div>
                    </div>
                </div>

                <div class="flex items-center px-5 py-3 bg-brand-card/20 backdrop-blur-md border-b border-brand-border">
                    <h2 class="text-[10px] font-bold tracking-[0.25em] text-brand-dim uppercase">Approval Queue</h2>
                </div>
                <div id="approval-list" class="flex-1 overflow-y-auto p-5 custom-scrollbar space-y-4">
                    <div class="flex flex-col items-center justify-center py-20 opacity-20 select-none">
                        <p
                            class="text-[10px] uppercase tracking-[0.4em] font-bold text-brand-dim text-center leading-relaxed">
                            System Idle<br>Awaiting Signal...</p>
                    </div>
                </div>
            </section>
        </main>

        <footer
            class="h-8 flex items-center justify-between px-6 bg-brand-bg border-t border-brand-border text-[9px] font-mono tracking-widest text-brand-dim uppercase">
            <div class="flex items-center gap-6">
                <div>Ticker: <span id="meta-symbol" class="text-brand-cyan">BTCUSDT</span></div>
                <div class="flex items-center gap-2">
                    <span class="w-1.5 h-1.5 rounded-full bg-brand-green"></span>
                    Node: <span class="text-white">PROD_VPS_OS_01</span>
                </div>
                <div class="hidden md:flex items-center gap-4 border-l border-white/10 pl-4 ml-2">
                    <div>CPU: <span id="cpu-val" class="text-white">--</span></div>
                    <div>RAM: <span id="ram-val" class="text-white">--</span></div>
                    <div>DISK: <span id="disk-val" class="text-white">--</span></div>
                </div>
            </div>
            <div class="flex items-center gap-6">
                <div>Latency: <span class="text-brand-green">14ms</span></div>
                <div id="uptime" class="text-white">00:00:00</div>
            </div>
        </footer>

        <!-- Overlays Layer -->
        <div id="logs-overlay"
            class="overlay hidden fixed inset-0 z-[100] flex items-center justify-center p-6 bg-black/60 backdrop-blur-sm">
            <div
                class="w-full max-w-3xl bg-brand-bg border border-brand-border rounded-2xl shadow-2xl flex flex-col h-[75vh] overflow-hidden">
                <div class="flex items-center justify-between px-6 py-4 border-b border-brand-border bg-brand-card/30">
                    <div class="flex items-center gap-6">
                        <h3 class="text-xs font-bold tracking-widest uppercase text-brand-cyan">Command Intelligence
                            Logs</h3>
                        <div id="log-tabs-nav" class="flex gap-1 p-1 bg-black/40 rounded-lg border border-white/5">
                            <button onclick="setLogTab('ALL')" data-category="ALL"
                                class="log-tab active">General</button>
                            <button onclick="setLogTab('CORE')" data-category="CORE" class="log-tab">Core Ops</button>
                            <button onclick="setLogTab('EXCH')" data-category="EXCH" class="log-tab">Exchange</button>
                            <button onclick="setLogTab('TRADE')" data-category="TRADE" class="log-tab">Trades</button>
                            <button onclick="setLogTab('ERR')" data-category="ERR"
                                class="log-tab text-red-400">Errors</button>
                        </div>
                    </div>
                    <button class="text-lg opacity-40 hover:opacity-100 transition-opacity"
                        onclick="toggleOverlay('logs-overlay')">√ó</button>
                </div>
                <div id="log-list"
                    class="flex-1 overflow-y-auto p-6 font-mono text-[11px] leading-relaxed space-y-1 custom-scrollbar">
                </div>
                <div class="p-4 border-t border-brand-border bg-brand-card/10 flex gap-4">
                    <button id="cleanup-btn"
                        class="flex-1 py-2 bg-brand-red/10 text-brand-red text-[10px] font-bold uppercase rounded-lg border border-brand-red/20 hover:bg-brand-red/20 transition-all">Archive
                        & Purge Logs</button>
                </div>
            </div>
        </div>

        <div id="files-overlay"
            class="overlay hidden fixed inset-0 z-[100] flex items-center justify-center p-6 bg-black/60 backdrop-blur-sm">
            <div
                class="w-full max-w-lg bg-brand-bg border border-brand-border rounded-2xl shadow-2xl flex flex-col max-h-[80vh] overflow-hidden">
                <div class="flex items-center justify-between px-6 py-4 border-b border-brand-border bg-brand-card/30">
                    <h3 class="text-xs font-bold tracking-widest uppercase">Intel Data Vault</h3>
                    <button class="text-lg opacity-5 hover:opacity-100 transition-opacity"
                        onclick="toggleOverlay('files-overlay')">√ó</button>
                </div>
                <div class="p-6 flex flex-col h-full overflow-hidden">
                    <div class="flex items-center gap-2 mb-6 p-1 bg-white/5 border border-white/10 rounded-xl">
                        <select id="file-target" class="bg-transparent text-[11px] font-bold px-3 py-2 outline-none">
                            <option value="reference">Reference Library</option>
                            <option value="data">Market Data Sets</option>
                        </select>
                        <button id="upload-btn"
                            class="flex-1 py-2 bg-white/5 hover:bg-white/10 text-[10px] font-bold uppercase rounded-lg transition-all">Upload
                            File</button>
                    </div>
                    <div id="file-list"
                        class="flex-1 overflow-y-auto custom-scrollbar font-mono text-[10px] text-brand-dim space-y-2">
                    </div>
                </div>
            </div>
        </div>
        <div id="recon-overlay"
            class="overlay hidden fixed inset-0 z-[100] flex items-center justify-center p-6 bg-black/60 backdrop-blur-sm">
            <div
                class="w-full max-w-2xl bg-brand-bg border border-brand-border rounded-2xl shadow-2xl flex flex-col h-[80vh] overflow-hidden">
                <div class="flex items-center justify-between px-6 py-4 border-b border-brand-border bg-brand-card/30">
                    <h3 class="text-xs font-bold tracking-widest uppercase text-brand-red">Mission Reconnaissance
                        Archives</h3>
                    <button class="text-lg opacity-40 hover:opacity-100 transition-opacity"
                        onclick="toggleOverlay('recon-overlay')">√ó</button>
                </div>
                <div id="recon-history" class="flex-1 overflow-y-auto p-6 space-y-4 custom-scrollbar">
                    <!-- Historical scans -->
                </div>
            </div>
        </div>
    </div>

    <!-- Master Command Draggable Widget -->
    <div id="fab-widget" style="position: fixed; bottom: 40px; right: 40px; z-index: 1000; width: 60px; height: 60px;">
        <!-- FAB Menu (Options Area) -->
        <div id="fab-menu" class="hidden absolute bottom-16 right-0 flex flex-col gap-3 mb-2 items-end">
            <button onclick="openFabAction('command')" class="fab-menu-btn group">
                <span class="fab-menu-label">Terminal</span>
                <div class="fab-menu-icon bg-brand-cyan">üí¨</div>
            </button>
            <button onclick="openFabAction('recon')" class="fab-menu-btn group">
                <span class="fab-menu-label">Mission Recon</span>
                <div class="fab-menu-icon bg-brand-red">üî≠</div>
            </button>
            <button onclick="openFabAction('logs')" class="fab-menu-btn group">
                <span class="fab-menu-label">System Logs</span>
                <div class="fab-menu-icon bg-brand-green">üìã</div>
            </button>
            <button onclick="openFabAction('files')" class="fab-menu-btn group">
                <span class="fab-menu-label">Data Vault</span>
                <div class="fab-menu-icon bg-white/20">üìÅ</div>
            </button>
        </div>

        <div id="master-command-box" class="hidden glass"
            style="position: absolute; bottom: 75px; right: 0; width: 340px; height: 450px; border-radius: 16px; box-shadow: 0 20px 50px rgba(0,0,0,0.6); overflow: hidden; display: flex; flex-direction: column;">
            <div id="fab-drag-handle"
                class="px-5 py-3 bg-brand-cyan/10 border-b border-brand-cyan/20 flex items-center justify-between cursor-grab active:cursor-grabbing">
                <span class="text-[10px] font-bold tracking-[0.2em] text-brand-cyan uppercase">Master Command</span>
                <button class="text-brand-cyan/40 hover:text-brand-cyan transition-colors"
                    onclick="openFabAction('command')" style="font-size: 1.5rem; line-height: 1;">√ó</button>
            </div>
            <div id="chat-messages" class="chat-messages custom-scrollbar">
                <div class="msg bot">Terminal ready. Awaiting institutional directive.</div>
            </div>
            <div class="chat-input-row bg-brand-bg/50 backdrop-blur-md">
                <input type="text" id="chat-input" placeholder="Execute command..." autocomplete="off">
                <button id="send-btn">EXEC</button>
            </div>
        </div>

        <button id="fab-button" onclick="toggleFabMenu(event)"
            class="w-14 h-14 bg-brand-cyan rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(0,242,255,0.4)] hover:scale-105 transition-transform active:scale-95 animate-pulse-cyan">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#000" stroke-width="2.5"
                stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg>
        </button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/static/script.js?v=5.5.0"></script>
</body>

</html>